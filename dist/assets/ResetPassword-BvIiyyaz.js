import{r,a4 as C,bh as E,V as L,j as e,X as f,W as V,a3 as d}from"./index-q1shbo1Y.js";import{L as m}from"./lock-6BJETC3b.js";import{E as p}from"./eye-off-BzFpDqmh.js";import{E as w}from"./eye-D1TDm-Nb.js";const R=()=>{const[a,h]=r.useState(""),[l,b]=r.useState(""),[i,y]=r.useState(!1),[c,j]=r.useState(!1),[x,u]=r.useState(!1),[t,N]=r.useState({}),[g,v]=r.useState(!1),n=C();E();const{updatePassword:P}=L();r.useEffect(()=>{(async()=>{const{data:{session:o}}=await V.auth.getSession();o?v(!0):(d.error("Invalid or expired reset link"),n("/"))})()},[n]);const S=()=>{const s={};return a.trim()?a.length<6&&(s.password="Password must be at least 6 characters"):s.password="Password is required",l.trim()?a!==l&&(s.confirmPassword="Passwords do not match"):s.confirmPassword="Please confirm your password",N(s),Object.keys(s).length===0},k=async s=>{if(s.preventDefault(),!!S()){u(!0);try{const{error:o}=await P(a);o?d.error(o.message):(d.success("Password updated successfully!"),n("/deals"))}catch{d.error("Failed to update password")}finally{u(!1)}}};return g?e.jsx("div",{className:"min-h-screen pt-20 flex items-center justify-center py-16",children:e.jsx("div",{className:"max-w-md w-full mx-4",children:e.jsxs("div",{className:"bg-surface rounded-2xl p-8 border border-border",children:[e.jsxs("div",{className:"text-center mb-8",children:[e.jsx("div",{className:"w-16 h-16 bg-gradient-to-r from-primary to-secondary rounded-full flex items-center justify-center mx-auto mb-4",children:e.jsx(m,{className:"w-8 h-8 text-white"})}),e.jsx("h1",{className:"text-2xl font-bold text-text mb-2",children:"Set New Password"}),e.jsx("p",{className:"text-textSecondary",children:"Enter your new password below"})]}),e.jsxs("form",{onSubmit:k,className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-text mb-2",children:"New Password"}),e.jsxs("div",{className:"relative",children:[e.jsx(m,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-textSecondary w-5 h-5"}),e.jsx("input",{type:i?"text":"password",value:a,onChange:s=>h(s.target.value),className:`w-full pl-10 pr-12 py-3 bg-background border rounded-lg focus:ring-2 focus:ring-primary focus:border-transparent transition-all ${t.password?"border-red-500":"border-border"}`,placeholder:"Enter your new password"}),e.jsx("button",{type:"button",onClick:()=>y(!i),className:"absolute right-3 top-1/2 transform -translate-y-1/2 text-textSecondary hover:text-text",children:i?e.jsx(p,{className:"w-5 h-5"}):e.jsx(w,{className:"w-5 h-5"})})]}),t.password&&e.jsxs("p",{className:"text-red-500 text-sm mt-1 flex items-center",children:[e.jsx(f,{className:"w-4 h-4 mr-1"}),t.password]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-text mb-2",children:"Confirm New Password"}),e.jsxs("div",{className:"relative",children:[e.jsx(m,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-textSecondary w-5 h-5"}),e.jsx("input",{type:c?"text":"password",value:l,onChange:s=>b(s.target.value),className:`w-full pl-10 pr-12 py-3 bg-background border rounded-lg focus:ring-2 focus:ring-primary focus:border-transparent transition-all ${t.confirmPassword?"border-red-500":"border-border"}`,placeholder:"Confirm your new password"}),e.jsx("button",{type:"button",onClick:()=>j(!c),className:"absolute right-3 top-1/2 transform -translate-y-1/2 text-textSecondary hover:text-text",children:c?e.jsx(p,{className:"w-5 h-5"}):e.jsx(w,{className:"w-5 h-5"})})]}),t.confirmPassword&&e.jsxs("p",{className:"text-red-500 text-sm mt-1 flex items-center",children:[e.jsx(f,{className:"w-4 h-4 mr-1"}),t.confirmPassword]})]}),e.jsx("button",{type:"submit",disabled:x,className:"w-full bg-gradient-to-r from-primary to-secondary text-white py-3 rounded-lg font-medium hover:from-primary/90 hover:to-secondary/90 transition-all disabled:opacity-50 disabled:cursor-not-allowed",children:x?e.jsxs("div",{className:"flex items-center justify-center",children:[e.jsx("div",{className:"w-5 h-5 border-2 border-white border-t-transparent rounded-full animate-spin mr-2"}),"Updating Password..."]}):"Update Password"})]}),e.jsx("div",{className:"mt-6 text-center",children:e.jsx("button",{onClick:()=>n("/"),className:"text-textSecondary hover:text-primary transition-colors text-sm",children:"Back to Home"})})]})})}):e.jsx("div",{className:"min-h-screen pt-20 flex items-center justify-center",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"w-16 h-16 border-4 border-primary border-t-transparent rounded-full animate-spin mx-auto mb-4"}),e.jsx("p",{className:"text-textSecondary",children:"Verifying reset link..."})]})})};export{R as default};
